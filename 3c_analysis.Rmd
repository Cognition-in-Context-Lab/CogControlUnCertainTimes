---
title: "3C Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Packages
library("ggpubr")
library(psych)
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
#install.packages("Hmisc")
#install.packages("lmtest")
#install.packages("jtools")
#install.packages("interactions")
#install.packages("lm.beta")
#install.packages("car")
#install.packages("sandwich")
#install.packages("ggrepel")
library(sandwich)
library(car)
library(jtools)
library(interactions)
library(lm.beta)
library(lmtest)
library(Hmisc)
library(dplyr)
#library(plyr)
```
# Analyses 

## load final dataset
```{r}
omit_df <- read.csv("omit_df.csv", header=T, na.strings="")
```


## Summary statistics
```{r}

#MCQ

mean(omit_df$logMeanK)

histogram(omit_df$logMeanK)

#Mean discounting on MCQ = -4.906, fairly normal distrubution 

```

## Demographics  

```{r}
## number of included participants
#study requested 400 participants: 
#original df dataset had 444 rows, removed 61 rows in processing script (unneeded rows, incomplete trials, low cons scores for MCQ and too short or too long entries) = 383 rows 

nrow(omit_df) # 383 rows

#duration, demographics

mean(omit_df$Duration..in.seconds.)
sd(omit_df$Duration..in.seconds.)

summary(omit_df$Age)
mean(omit_df$Age)
sd(omit_df$Age)
max(omit_df$Age)
table(omit_df$Gender)
table(omit_df$Race)
table(omit_df$Education)
```

## Demographics Cont.  


```{r}
#Age
hist(omit_df$Age)

#Gender
# 1) create new variable with gender recoded as a factor
omit_df$GenderasFactor <- factor(omit_df$Gender, levels=1:8, labels=c("male", "female", "non-binary", "other", "prefer not to answer", "trans man", "trans woman", "genderqueer"))
# 2) create barplot with new Gender variable
ggplot(omit_df) +
  geom_bar(aes(x = GenderasFactor)) +
  ggtitle("Count of Gender") +
  theme(plot.title = element_text(hjust = 0.5))

#Education
omit_df$EducationasFactor <- factor(omit_df$Education, levels=1:6, labels=c("Unknown","No hs diploma","No college","Some college","4 yr college","Graduate degree"))
ggplot(omit_df) +
  geom_bar(aes(x = EducationasFactor)) +
  ggtitle("Count of Education") +
  theme(plot.title = element_text(hjust = 0.5))

#Race
omit_df$RaceasFactor <- factor(omit_df$Race, levels=1:7, labels=c("Am Indian","Asian","Pacific Islander","Black","White","Multiple","Unknown"))
ggplot(omit_df) +
  geom_bar(aes(x = RaceasFactor)) +
  ggtitle("Count of Race") +
  theme(plot.title = element_text(hjust = 0.5))

# Relations between variables
#ggplot(data = omit_df) + 
  #geom_point(mapping = aes(x = COVID_DoG_Sum, y = Perceived_Risk_Sum))

```

## Analyzing political breakdown of sample

```{r}

#find how many people put 4 or 5 for each orientation (liberal conservative, libertarian)
length(which(omit_df$Measure2_liberal_Index == 4)) + length(which(omit_df$Measure2_liberal_Index == 5)) #liberal

length(which(omit_df$Measure2_cons_Index == 4)) + length(which(omit_df$Measure2_cons_Index == 5)) #conservative

length(which(omit_df$Measure2_liberterian_Index == 4)) + length(which(omit_df$Measure2_liberterian_Index == 5)) #libertarian

#however, not everyone put a 4 or 5 in their answers. so...

#check which orientation if greatest for each person
omit_df$which_Measure2 = ifelse((omit_df$Measure2_liberal_Index > omit_df$Measure2_cons_Index) & (omit_df$Measure2_liberal_Index > omit_df$Measure2_liberterian_Index), 'liberal',
                      ifelse((omit_df$Measure2_cons_Index > omit_df$Measure2_liberal_Index) & (omit_df$Measure2_cons_Index > omit_df$Measure2_liberterian_Index), 'conservative', 
                      ifelse((omit_df$Measure2_liberterian_Index > omit_df$Measure2_liberal_Index) & (omit_df$Measure2_liberterian_Index > omit_df$Measure2_cons_Index),'libertarian', 'none')))

length(which(omit_df$which_Measure2 == 'liberal'))
length(which(omit_df$which_Measure2 == 'conservative'))
length(which(omit_df$which_Measure2 == 'libertarian'))

#just find average of each column
mean(omit_df$Measure2_liberal_Index)
mean(omit_df$Measure2_cons_Index)
mean(omit_df$Measure2_liberterian_Index)

#what does it look like on a table?
omit_df %>% 
  select(X,Measure2_liberal_Index,Measure2_cons_Index,Measure2_liberterian_Index) %>% 
  pivot_longer(cols=starts_with("Measure"),
               names_to="politics",
               values_to="response"
               ) %>%
  group_by(politics,response) %>%
  summarise(count=n())

```

#Creating dummy variables for political oreintation 

```{r}

omit_df$Political_Orient_Cat = ifelse((omit_df$Measure2_liberal_Index > omit_df$Measure2_cons_Index) & (omit_df$Measure2_liberal_Index > omit_df$Measure2_liberterian_Index), 'liberal',
                      ifelse((omit_df$Measure2_cons_Index > omit_df$Measure2_liberal_Index) & (omit_df$Measure2_cons_Index > omit_df$Measure2_liberterian_Index), 'zconservative', 
                      ifelse((omit_df$Measure2_liberterian_Index > omit_df$Measure2_liberal_Index) & (omit_df$Measure2_liberterian_Index > omit_df$Measure2_cons_Index),'libertarian', 'none')))


```

## Linear Regressions. 1. Hypotheses can be found here: https://docs.google.com/spreadsheets/d/13zLnwjl7KTG4vASnhsG4ksfv95MHUM-4k6LtwOfnhho/edit?usp=sharing 2. Analysis documentation can be found here: https://docs.google.com/document/d/1ktOSEvA9BqKJ9pxmGovnPosLf7GjM64UDgwlBucpqU4/edit?usp=sharing

## Main Models of Interest 

### MCQ and Uncertainty:People who report less confidence about the future should delay less on the adopted COVID 19 specific DoG Task and report more temporal discounting. 

```{r}

#Visualizing the data

ggscatter(omit_df, x = "GCS_index", y = "logMeanK", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "GCS_index", ylab = "logMeanK")

#Running the linear model

GCSModel1 <-  lm(logMeanK ~ GCS_index, data =  omit_df)

summary(GCSModel1)

plot(GCSModel1)

bptest(GCSModel1)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns. 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end with some falling off. 

#3 Scale-Location:homoscedasticity test. Relativity flat line, but sig number in bptest.

#4 No dots outside of cooks line. good! 

outlierTest(GCSModel1)

#outliers == no outliers 


coeftest(GCSModel1, vcov = vcovHC(GCSModel1, "HC1")) 

```

```{r}
#MCQ and uncertainty plots
plot(logMeanK ~ GCS_index, data =  omit_df)
abline(GCSModel1)
```

### COVID DoG and Uncertainity: People who report less confidence about the future should delay less on the adopted COVID 19 specific DoG Task.  

```{r}

#let's visualize the data

ggscatter(omit_df, x = "logCOVID_DoG_index", y = "GCS_index", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "COVID DoG ", ylab = "General Uncertainity ")

GCSModel2 <- lm(logCOVID_DoG_index ~ GCS_index, data = omit_df)

summary(GCSModel2)

#checking assumptions for model

plot(GCSModel2)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning with some severe falling off. 

#3 Scale-Location:homoscedasticity test. Downward slopped line. 

bptest(GCSModel2)

#Sig reported in bptest 

#4 No dots outside of cooks line. good! 

#Are there outliers in the model?

outlierTest(GCSModel2)

#There are no outliers. 
```

### COVID DoG and MCQ (K indice): People who report more discounting on the general DoG measure will delay less on the adopted COVID 19 specific DoG Task
```{r}

#lets graph the raw data and mark model outliers before the model gets fit

#here are the outliers from the model, sub setted into their own data frame. 

MCQMOdeloutliers <- omit_df[(omit_df$id=="226" | omit_df$id=="268" |omit_df$id=="278" |omit_df$id=="69" | omit_df$id=="25" |omit_df$id=="36" |omit_df$id=="54" | omit_df$id=="166" |omit_df$id=="167" |omit_df$id=="19" | omit_df$id=="119" |omit_df$id=="142" | omit_df$id=="252" |omit_df$id=="20" | omit_df$id=="61"),]

#What do the outliers look like compared to the rest of the data?

MCQModelRaw <- ggplot(omit_df, aes(x= logCOVID_DoG_index, y= logMeanK)) +
  geom_point()

MCQModelRaw + geom_label_repel(data = subset(MCQMOdeloutliers), aes(label = "outlier", size = NULL, color = NULL))


MCQModel1 <- lm(logCOVID_DoG_index ~ logMeanK, data =  omit_df)

summary(MCQModel1)

plot(MCQModel1)

bptest(MCQModel1)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns. 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning with severe falling off. 

#3 Scale-Location:homoscedasticity test. Relativity flat line. No sig number in bptest. 

#4 No dots outside of cooks line. 

outlierTest(MCQModel1)

#there are outliers! 

# What does it look like if we remove outliers?

omit_df_MCQModel2_outliers <-omit_df[!(omit_df$id=="226" | omit_df$id=="268" |omit_df$id=="278" |omit_df$id=="69" | omit_df$id=="25" |omit_df$id=="36" |omit_df$id=="54" | omit_df$id=="166" |omit_df$id=="167" |omit_df$id=="19" | omit_df$id=="119" |omit_df$id=="142" | omit_df$id=="252" |omit_df$id=="20" | omit_df$id=="61"),]

MCQModel2 <- lm(logCOVID_DoG_index ~ logMeanK, data =  omit_df_MCQModel2_outliers)

summary(MCQModel2)

plot(MCQModel2)

bptest(MCQModel2)

outlierTest(MCQModel2)

#All good now!

```

```{r}
#MCQ and COVID DoG plots
##model1
plot(logCOVID_DoG_index ~ logMeanK, data =  omit_df)
abline(MCQModel1)

##model 2
plot(logCOVID_DoG_index ~ logMeanK, data =  omit_df)
abline(MCQModel2)
```

### COVID DoG and Poltiical Orientation (Everett 2013): Individuals will vary systematically in COVID Specific DoG and norms by political orientation. Specifically,  Conservatives will delay less than Liberals on the COVID19 DoG task and report norms that favor immediate gratification. In addition, conservative ideology will be more predictive than the Harm/Purity foundation in predicting COVID19 DoG.

```{r}


PoliticalOrientationModel1  = lm(logCOVID_DoG_index ~ Political_Orient_Cat, data = omit_df)

summary(PoliticalOrientationModel1)

PoliticalOrientationModel1 <- lm(logCOVID_DoG_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df)

summary(PoliticalOrientationModel1)

plot(PoliticalOrientationModel1)

bptest(PoliticalOrientationModel1)


#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning with some severe falling off. 

#3 Scale-Location:homoscedasticity test. Relativity flat line. Sig number in BP test.

#4 No dots outside of cooks line. good! 

outlierTest(PoliticalOrientationModel1)

#outliers == 10

#Need to remove outliers

#We got a serious case of heteroscedaciity folks. What does a model with robust standard errors look like? 

coeftest(PoliticalOrientationModel2, vcov = vcovHC(PoliticalOrientationModel2, "HC1")) 

#vs

summary(PoliticalOrientationModel2) 

#Model adjusted slightly, but relatively the same


```

### other political variable (Diaz 2020): Individuals will vary systematically in COVID Specific DoG and norms by political orientation. Specifically,  Conservatives will delay less than Liberals on the COVID19 DoG task and report norms that favor immediate gratification. In addition, conservative ideology will be more predictive than the Harm/Purity foundation in predicting COVID19 DoG. 

```{r}

PoliticalOrientationModel3 <- lm(logCOVID_DoG_index ~ Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df)

summary(PoliticalOrientationModel3)

plot(PoliticalOrientationModel3)

outlierTest(PoliticalOrientationModel3)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for some falling towards the end 

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

bptest(PoliticalOrientationModel3)

#we got heteroscedasticity

#4 No dots outside of cooks line. good! 

coeftest(PoliticalOrientationModel3, vcov = vcovHC(PoliticalOrientationModel3, "HC1")) 

#vs

summary(PoliticalOrientationModel3) 

#Liberal Index is now significant, as well as the cons index is still sig. 


```

### Moral Foundations and COVID DoG: Individuals will vary in the DoG on the COVID 19 specific task by moral foundations. Specifically, individuals high in harm/care and purity/sanctity will delay more in the context of COVID19 than those lower in high in harm/care and purity/sanctity. 

```{r}

 MFTModel1 <- lm(logCOVID_DoG_index ~ harm_foundation + fairness_foundation + authority_foundation + ingroup_foundation +purity_foundation, data = omit_df)
               
summary(MFTModel1)

plot(MFTModel1)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning which has some severe falling off.  

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(MFTModel1)

#bptest is sig! 

#4 No dots outside of cooks line. good! 

#Do we have outliers?

outlierTest(MFTModel1)

#outliers == 253,10,59

omit_df_MFTModel1_outliers <-omit_df[!(omit_df$id=="19" | omit_df$id=="69" |omit_df$id=="268" |omit_df$id=="166" |omit_df$id=="142"|omit_df$id=="278" |omit_df$id=="54"|omit_df$id=="252" |omit_df$id=="167"|omit_df$id=="119" |omit_df$id=="20" |omit_df$id=="226" |omit_df$id=="25" |omit_df$id=="36" |omit_df$id=="61"),]

 MFTModel2 <- lm(logCOVID_DoG_index ~ harm_foundation + fairness_foundation + authority_foundation + ingroup_foundation +purity_foundation, data = omit_df_MFTModel1_outliers)

#do we have any other ouliers?
 
outlierTest(MFTModel2)

#outiers == 156, 132, 262, 44, 238, 157, 109, 11, 212, 15, 26, 51
               
summary(MFTModel2)

plot(MFTModel2)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end which has still has some falling off

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(MFTModel1)

#bptest is still sig! 

#4 No dots outside of cooks line. good


```

#### MFT, Political Orientation, and DoG: Conservative ideology will be more predictive than the Harm/Purity foundation in predicting COVID19 DoG.

```{r}

#Do these effects still remain when doing a multiple linear regression w/ political ideology included? (Diaz 2020)

 MFTModel2 <- lm(logCOVID_DoG_index ~ harm_foundation + fairness_foundation + authority_foundation + ingroup_foundation +purity_foundation +Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df)
               
summary(MFTModel2)

plot(MFTModel2)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning which has some severe falling off.  

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(MFTModel2)

#bptest is sig! 

#4 No dots outside of cooks line. good! 

#What about if we do the other political ideology measure? (Evertt 2013)

MFTModel3 <- lm(logCOVID_DoG_index ~ harm_foundation + fairness_foundation + authority_foundation + ingroup_foundation +purity_foundation + Measure5_Social_Index + Measure5_Political_Index, data = omit_df)
               
summary(MFTModel3)

plot(MFTModel3)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning which has some severe falling off.  

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(MFTModel3)

#bptest is sig! 

#4 No dots outside of cooks line. good! 
```

## other manuscript models 

### MCQ and Moral Foudnations: No specfiic hypothesis. 

```{r}

MFTModel5 <- lm(logMeanK ~ harm_foundation + fairness_foundation + authority_foundation + ingroup_foundation +purity_foundation, data = omit_df)
               
summary(MFTModel5)

plot(MFTModel5)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end which have some falling off. 

#3 Scale-Location:homoscedasticity test. Flat-ish line. 

bptest(MFTModel5)

# No sig Bptest 

#4 No dots outside of cooks line. good! 

#Are there outliers?

outlierTest(MFTModel5)

#no outliers 
```


### COVID DoG and Social Deserability Measure: No specific Hypothesis 

```{r}

SocialDesirabilityModel <- lm(logCOVID_DoG_index ~ SDRS_Sum_scaled, data = omit_df)

summary(SocialDesirabilityModel)

plot(SocialDesirabilityModel)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning with some severe falling off. 

#3 Scale-Location:homoscedasticity test. Relativity flat line. 

#4 No dots outside of cooks line. good! 

##Looking into closer to residuals not being normally distributed 

#Are there outliers in the model?

outlierTest(SocialDesirabilityModel)

leveragePlots(SocialDesirabilityModel)

#what does it look like when we remove those outliers?

SocialDesirabilityModel2 <- lm(logCOVID_DoG_index ~ SDRS_Sum_scaled, data = omit_df_final)

summary(SocialDesirabilityModel2)

plot(SocialDesirabilityModel2)

outlierTest(SocialDesirabilityModel2)

bptest(SocialDesirabilityModel2)

#no hetero

#The QQ plot looks a lot better and there are no remaining outliers. 

```

### Norms + COVID DoG: People who report that social norms (based on participants perceptions of family, friends, and strangers opinions) favor immediate gratification should show less delaying on the adopted COVID 19 specific DoG Task

```{r}
NormsModel1 <- lm(logCOVID_DoG_index ~ FamilyNorm_index + FriendsNorm_index + StrangerNorm_index, data = omit_df)

summary(NormsModel1)

plot(NormsModel1)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning with some severe falling off. 

#3 Scale-Location:homoscedasticity test. Not a flat line, concerning. 

#4 No dots outside of cooks line. good! 

#lets see what things look like using the final dataset 

NormsModel2 <- lm(logCOVID_DoG_index ~ FamilyNorm_index + FriendsNorm_index + StrangerNorm_index, data = omit_df_final)

summary(NormsModel2)

plot(NormsModel2)

#1 Residuals Plot: Linear assumption met, flat line w/ no patterns.

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part!

#3 Scale-Location:homoscedasticity test. Relatively flat! 

bptest(NormsModel2)

#just barely sig!

#4 No dots outside of cooks line. good! 

coeftest(NormsModel2, vcov = vcovHC(NormsModel2, "HC1")) 

#vs

summary(NormsModel2) 

#same significance, just different levels of sig


```

### COVID DoG, Stress, Experience, and Impact: Individuals with more experience, impact, and stress with COVID will delay more on the COVID specific DoG task. 

```{r}

COVIDImpactStress <- lm(logCOVID_DoG_index ~ Impacts_index + Stress_index + Personal_Diagnoses_index + Proximity_to_others_index + News_index, data = omit_df_final) 

summary(COVIDImpactStress)

plot(COVIDImpactStress)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? Good!

#3 Scale-Location: Relatively flat line. 

bptest(COVIDImpactStress)

#no heteroscadicity! 

#4 No dots outside of cooks line. good! 

```

### Political Orientation and DoG, moderated by Impact and Experiences: COVID impact, stress, experience will moderate the relationship between Political Orientation and COVID Specific DoG. Conservatives on the whole will delay less than liberals on the COVID19 specific DoG Task. However, conservatives who have more impact, stress, and experience will delay more than who conservatives who have less impact, stress, and experience.

```{r}
#the actual models
impact_mod <- lm(COVID_DoG_index ~ Measure2_cons_Index*Impacts_index,
  data=omit_df)
summary (impact_mod)

#experiences_mod <- lm(COVID_DoG_index ~ Measure2_cons_Index*Personal_Diagnoses_index,
  #data=omit_df)
#summary (experiences_mod)

stress_mod <- lm(COVID_DoG_index ~ Measure2_cons_Index*Stress_index,
  data=omit_df)
summary (stress_mod)

outlierTest(impact_mod)
#outlierTest(experiences_mod)
outlierTest(stress_mod)

#no outliers

#would it be worth it to ask Winnie what she thinks about removing outliers based on Cook's distance? I only found the influential values here, didn't remove them
cooksD <- cooks.distance(impact_mod)
influential_impact <- cooksD[(cooksD > (3 * mean(cooksD, na.rm = TRUE)))]
influential_impact
#cooksD <- cooks.distance(experiences_mod)
#nfluential_experiences <- cooksD[(cooksD > (3 * mean(cooksD, na.rm = TRUE)))]
#influential_experiences
cooksD <- cooks.distance(stress_mod)
influential_stress <- cooksD[(cooksD > (3 * mean(cooksD, na.rm = TRUE)))]
influential_stress

#plotting simple slopes
#install.packages("rockchalk")
library(rockchalk)
plotCurves(impact_mod, plotx="Measure2_cons_Index", modx="Impacts_index", interval="confidence")
#plotCurves(experiences_mod, plotx="Measure2_cons_Index", modx="Personal_Diagnoses_index", interval="confidence")
plotCurves(stress_mod, plotx="Measure2_cons_Index", modx="Stress_index", interval="confidence")

#Impacts
#Average is the blue line. people with less impact had a very slight smaller delay of gratification as they were a higher degree of conservative. people with more impact had a very slight larger delay of gratification as they were a higher degree of conservative.

#Experiences
#Average is the blue line. generally, as people became more conservative, they had lower delay of gratification. experience did not seem to moderate?

#Stress
#Average is the blue line. people with less stress had a slight smaller delay of gratification as they were a higher degree of conservative. people with more stress had a  slight larger delay of gratification as they were a higher degree of conservative. moderated well
```

## Misc Models 

### Norms and Political Oreintation (Everett 2013): Conservatives will report norms that favor immediate gratification. 

```{r}

PoliticalOrientationModel4 <- lm(Norms_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df)

summary(PoliticalOrientationModel4)

plot(PoliticalOrientationModel4)

#1 Residuals Plot: Relatively flat line.   

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end, but not too bad. 

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

#4 No dots outside of cooks line. good! 

#What about final dataset?

PoliticalOrientationModel5 <- lm(Norms_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df_final)

summary(PoliticalOrientationModel5)

plot(PoliticalOrientationModel5)

outlierTest(PoliticalOrientationModel5)

#1 Residuals Plot: relatively flat line -- linearity seems to be here! 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end, but not too bad. 

#3 Scale-Location:homoscedasticity test. Relativity flat line

bptest(PoliticalOrientationModel5)

#heteroscedacity is here! 

#4 No dots outside of cooks line. good! 

```

```{r}
#addressing Heteroskedasticity in the model

coeftest(PoliticalOrientationModel5, vcov = vcovHC(PoliticalOrientationModel5, "HC1")) 

#vs

summary(PoliticalOrientationModel5) 

#same results, less significance 

```

### Norms and Political Orientation (Diaz 2020): Conservatives will report norms that favor immediate gratification.

```{r}
PoliticalOrientationModel6 <- lm(Norms_index ~ Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df_final)

summary(PoliticalOrientationModel6)

plot(PoliticalOrientationModel6)

outlierTest(PoliticalOrientationModel6)

#1 Residuals Plot: relatively flat line -- linearity seems to be here! 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning and end, but not too bad. 

#3 Scale-Location:homoscedasticity test. Relativity flat line. 

bptest(PoliticalOrientationModel6)

#heteroscedacity is here! 

#4 No dots outside of cooks line. good! 

```

```{r}
#addressing Heteroskedasticity in the model

coeftest(PoliticalOrientationModel6, vcov = vcovHC(PoliticalOrientationModel6, "HC1")) 

#vs

summary(PoliticalOrientationModel6) 

#same results

```

#### Family Norms and Political Oreintation (Everett 2013): Conservatives will report norms that favor immediate gratification.

```{r}
PoliticalOrientationModel7 <- lm(FamilyNorm_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df_final)

summary(PoliticalOrientationModel7)

plot(PoliticalOrientationModel7)

outlierTest(PoliticalOrientationModel7)

#1 Residuals Plot: Relatively flat line! 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the end. 

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(PoliticalOrientationModel7)

#hetero is present 

#4 No dots outside of cooks line. good!

#addressing hetero

coeftest(PoliticalOrientationModel7, vcov = vcovHC(PoliticalOrientationModel7, "HC1")) 

#vs

summary(PoliticalOrientationModel7) 

#same levels of sig

```

#### Family Norms and Political Oreintation (Diaz 2020): Conservatives will report norms that favor immediate gratification.

```{r}

PoliticalOrientationModel8 <- lm(FamilyNorm_index ~ Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df_final)

summary(PoliticalOrientationModel8)

plot(PoliticalOrientationModel8)

outlierTest(PoliticalOrientationModel8)

#1 Residuals Plot: Relatively flat line! 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the end. 

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(PoliticalOrientationModel8)

#hetero present 

#4 No dots outside of cooks line good!

#addressing hetero

coeftest(PoliticalOrientationModel8, vcov = vcovHC(PoliticalOrientationModel8, "HC1")) 

#vs

summary(PoliticalOrientationModel8) 


#chagne in significance levels, robust standard error model only has liberal and cons as sig 


```

#### Friend Norms and Political Oreintation (Everett 2013): Conservatives will report norms that favor immediate gratification.

```{r}

PoliticalOrientationModel9 <- lm(FriendsNorm_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df_final)

summary(PoliticalOrientationModel9)

plot(PoliticalOrientationModel9)

outlierTest(PoliticalOrientationModel9)

#1 Residuals Plot: Relatively flat line! 

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? Looks pretty good! 

#3 Scale-Location:homoscedasticity test. Not a flat line. Concerning.

bptest(PoliticalOrientationModel9)

#hetero present 

#4 No dots outside of cooks line. good!

#addressing hetero

coeftest(PoliticalOrientationModel9, vcov = vcovHC(PoliticalOrientationModel9, "HC1")) 

#vs

summary(PoliticalOrientationModel9) 

#same results relatively  

```

#### Friend Norms and Political Oreintation (Diaz 2020): Conservatives will report norms that favor immediate gratification.

```{r}

PoliticalOrientationModel10 <- lm(FriendsNorm_index ~ Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df_final)

summary(PoliticalOrientationModel10)

plot(PoliticalOrientationModel10)

outlierTest(PoliticalOrientationModel10)

#1 Residuals Plot: Flat line!  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? Looks pretty good!

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

bptest(PoliticalOrientationModel10)

#hetero is present 

#4 No dots outside of cooks line. good! 

#addressing hetero

coeftest(PoliticalOrientationModel10, vcov = vcovHC(PoliticalOrientationModel10, "HC1")) 

#vs

summary(PoliticalOrientationModel10) 

#still significant, just different levels 

```

#### Stranger Norms and Political Oreintation (Everett 2013): Conservatives will report norms that favor immediate gratification.

```{r}
PoliticalOrientationModel11 <- lm(StrangerNorm_index ~ Measure5_Social_Index + Measure5_Political_Index, data = omit_df_final)

summary(PoliticalOrientationModel11)

plot(PoliticalOrientationModel11)

outlierTest(PoliticalOrientationModel11)

#1 Residuals Plot: Relatively flat.  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except they have lots of squiggles.

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

bptest(PoliticalOrientationModel11)

#heteroscadicity is present 

coeftest(PoliticalOrientationModel11, vcov = vcovHC(PoliticalOrientationModel11, "HC1")) 

#vs

summary(PoliticalOrientationModel11)

#no significance in this model anymore 

```

#### Stranger Norms and Political Oreintation (Diaz 2020): Conservatives will report norms that favor immediate gratification.

```{r}
#4 No dots outside of cooks line. good! 

PoliticalOrientationModel12 <- lm(StrangerNorm_index ~ Measure2_liberterian_Index + Measure2_liberal_Index + Measure2_cons_Index , data = omit_df_final)

summary(PoliticalOrientationModel12)

plot(PoliticalOrientationModel12)

outlierTest(PoliticalOrientationModel12)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except they have lots of squiggles. 

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

bptest(PoliticalOrientationModel12)

#no hetero

#4 No dots outside of cooks line. good! 

```

### Disgust and COVID DoG: People who report more pathogen disgust will delay more on the COVID19 DoG task. 

```{r}

DisgustModel1 <- lm(logCOVID_DoG_index ~ Pathogen_Disgust_index + Moral_Disgust_index + Sexual_Disgust_index, data = omit_df)
               
summary(DisgustModel1) 

plot(DisgustModel1)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning which has some severe falling off? 

#3 Scale-Location:homoscedasticity test. Relatively flat line. 

#4 No dots outside of cooks line. good! 

DisgustModel2 <- lm(logCOVID_DoG_index ~ Pathogen_Disgust_index + Moral_Disgust_index + Sexual_Disgust_index, data = omit_df_final)
               
summary(DisgustModel2) 

plot(DisgustModel2)

#1 Residuals Plot: Relatively flat  

#2 QQ Plot: Are the residuals normally distributed (follow a diagonal line)? For the most part, except for the beginning which has some falling off still. 

#3 Scale-Location:homoscedasticity test. Kind of concerning. 

bptest(DisgustModel2)

#no Heteroscedasticity

#4 No dots outside of cooks line. good! 

outlierTest(DisgustModel2)

# no outliers 


```

# MISC SECTION 

## Exploratory Factor Analysis for COVID DoG.  Creates csv of the df dataset AND csv with just the 6 questions (using transformed data with units in days) of COVID_DoG. Used by Winnie to do EFA separately, see EFA_Analysis Doc in 3C repo
```{r}
write.csv(df, 'df.csv')
write.csv(COVID_DoG, 'COVID_DoG.csv')
```